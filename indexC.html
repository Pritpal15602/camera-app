<!DOCTYPE html>
<html>

<head>
    <title>Compress Image file Client Side</title>
	<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  
   <script src="https://compressjs.herokuapp.com/compress.js"></script>

</head>

<body>
    
	
<h3>Demo</h3>

	<p>Upload an image and watch the file size before and after. </p>

	<div>
		<input type="file" name="" id="upload" accept="image/*;capture=camera" capture="user">
	</div>
	<div>
		<img src="" alt="" id="preview">

		<p id="output"></p>
	</div>
	
	<!-- <form action="server.cgi" method="post" enctype="multipart/form-data"> -->
  <!-- <input type="file" name="image" accept="image/*;capture=camera" capture="camera"> -->
  <!-- <input type="submit" value="Upload"> -->
<!-- </form> -->
	
	<script type="text/javascript">
	
	
		const compress = new Compress()
		const preview = document.getElementById('preview')
		const output = document.getElementById('output')

		const upload = document.getElementById('upload')

		upload.addEventListener('change', (evt) => {
		  const files = [...evt.target.files]
		  compress.compress(files, {
			size: 4, // the max size in MB, defaults to 2MB
			quality: 0.75, // the quality of the image, max is 1,
			maxWidth: 1920, // the max width of the output image, defaults to 1920px
			maxHeight: 1920, // the max height of the output image, defaults to 1920px
			resize: true // defaults to true, set false if you do not want to resize the image width and height
		  }).then((images) => {
			console.log(images)
			const img = images[0]
			// returns an array of compressed images
			preview.src = `${img.prefix}${img.data}`
			console.log(img)

			const { endSizeInMb, initialSizeInMb, iterations, sizeReducedInPercent, elapsedTimeInSeconds, alt } = img

			output.innerHTML = `<b>Start Size:</b> ${initialSizeInMb} MB <br/><b>End Size:</b> ${endSizeInMb} MB <br/><b>Compression Cycles:</b> ${iterations} <br/><b>Size Reduced:</b> ${sizeReducedInPercent} % <br/><b>File Name:</b> ${alt}`
		  })
		}, false)


	</script>
	

</body>

</html>
